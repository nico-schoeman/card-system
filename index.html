<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>Cards</title>
		<script type="module" src="./index.js"></script>
	</head>
	<body>
		<script type="module">
			import { html, render } from 'lit-html/lit-html.js';
			import { CardStore } from './index.js';
			import DataStore from '@nico-schoeman/data-store';
			import { BasicCard } from './card.factory.js';

			const store = new DataStore();

			let cs = new CardStore();
			let tokenStore = new DataStore();

			store.set('cards', cs);
			store.set('tokens', tokenStore);

			for (let index = 0; index < 30; index++) {
				let card = new BasicCard();
				card.effects.push(context => {
					console.log('can do action');
				});
        card.effects.push(() => {
          cs.drawUntil(5);
          console.log(cs.store.get('draw'), cs.store.get('hand'));
        });
				cs.addCardToDeck(card);
			}

			cs.setDraw();
			cs.shuffleDraw();
			cs.drawUntil(5);
			cs.discardFromHandRandom(1);

			console.log(store);

			tokenStore.set('tokens', [{}, {}]);

			export class Test extends HTMLElement {
				connectedCallback() {
					render(
						html`
							<c-deck id="draw-pile"></c-deck>
							<c-stage .store=${tokenStore}></c-stage>
							<c-hand .store=${cs}></c-hand>
							<c-discard id="discard-pile"></c-discard>
						`,
						this,
					);
				}
			}
			if (!customElements.get('c-test')) {
				customElements.define('c-test', Test);
			}
		</script>
		<c-test></c-test>
	</body>
</html>
